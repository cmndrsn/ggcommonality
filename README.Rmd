---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# ggcommonality

<!-- badges: start -->
<!-- badges: end -->

The goal of ggcommonality is to produce bar plots of unique and joint effects 
from commonality analyses. The function outputs a bar plots with unique and 
common effects for each commonality partition. The function is scalable and takes
formula notation for input. This package is very fresh, so its functionality is quite limited.

Partitions are plotted sequentially in alphabetical order, starting with unique effects
and are built iteratively with joint effects at higher orders on top. This means
there are redundancies between partitions, and the plot can be deceptive if you
don't take the total explained variance into account.

## Installation

You can install the development version of ggcommonality from [GitHub](https://github.com/) with:

``` r
# install.packages("pak")
pak::pak("cmndrsn/ggcommonality")
```

## Example

This is a basic example which shows you how to solve a common problem:

```{r example, warning=FALSE}
library(ggcommonality)
# import data
data(mtcars)
# fit model with yhat
yhat_model <- yhat::regr(
  lm(
    formula = mpg ~ cyl + disp + vs + drat,
    data = mtcars
    )
  )
ggcommonality(yhat_model) +
  ggplot2::theme_bw()
```
We can compare the bar plot output to the unique and common effects from the model:

```{r commonality, warning=FALSE}
knitr::kable(yhat_model$Commonality_Data$CC)
```

To get the x and y coordinates passed to `ggplot2::geom_rect()` when making the plot,
you can use the following line of code, which returns a list with (1) the data frame used to create the barplot for positive commonalities (from xmin, xmax, ymin, and ymax coordinates);
(2) the data frame used to create the black outline for the positive effects; (3) the data frame used to create the barplot for negative commonalities; and (4) the data frame used to create the black outline for the negative effects.

```{r}
get_commonality_barplot_df(yhat_model) 
```

A future version of the package will include the possibility to add the total explained variance as an additional bar. I would also like to incorporate bootstrapped confidence intervals.
